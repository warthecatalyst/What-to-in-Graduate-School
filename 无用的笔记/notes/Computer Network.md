# 计算机网络

## 结构
计算机网络有两种不同的结构，最经典的5层网络和7层网络，目前一般都是说5层网络：应用层、传输层、网络层、链路层和物理层。


## 应用层
HTTP常用状态码:1XX 信息型状态码（正在处理，2XX成功状态码，3XX重定向状态码，4XX客户端错误状态码，5XX服务端错误状态码

以下是一些经典的状态码：
| 状态码   | 备注     |
| -------- | -------- | 
| 100 | 继续：服务器已收到请求的一部分，等待其余部分； | 
| 101 | 切换协议：服务器已收到请求的一部分，等待其余部分； | 
| 301 | 永久重定向 | 
| 302 | 临时重定向 |
| 403 | 无权限 |
| 404 | 方法错误 |
| 405 | 方法禁用 |
| 500 | 服务器内部错误 |
| 504 | 网关超时 |

## 传输层
### TCP三次握手与四次挥手
1）第一次握手：建立连接时，客户端发送 syn 包（syn=x）到服务器，并进入 SYN_SENT 状态，等待服务器确认；

2）第二次握手：服务器收到 syn 包，须确认客户的 SYN（ack=x+1），同时自己也发送一个 SYN 包（syn=y），即 SYN+ACK 包，此时服务器进入 SYN_RECV 状态；

3）第三次握手：客户端收到服务器的 SYN+ACK 包，向服务器发送确认包 ACK(ack=y+1），此包发送完毕，客户端和服务器进入 ESTABLISHED（TCP连接成功）状态，完成三次握手。

## 网络层

## 安全
### 垂直越权与水平越权
垂直越权和水平越权分别代表了不同的安全问题：

水平越权：指攻击者通过篡改或伪造认证信息，从而获得访问同一层级或同一权限范围内其他用户所拥有的资源或信息的能力。例如，一个普通用户伪造了管理员的Token，从而获得了管理员权限，进而访问了属于管理员的资源。

垂直越权：指攻击者通过篡改或伪造认证信息，从而获得访问高一层级或更高权限范围内其他用户所拥有的资源或信息的能力。例如，一个普通用户篡改了自己的Token，成功获取了属于CEO或高管的权限，进而访问了高层次的资源和信息。

这些越权问题极具危害性，可能导致信息安全问题，用户隐私泄露以及系统失效等影响。因此，在实现系统时，测评和预防越权问题是十分必要的。

### JWT
JWT全称为JSON Web Token，是一种网络标准（RFC 7519），定义了一种用于在各方之间安全地传输信息的表示方法，通常用于身份验证和信息交换。它是基于JSON格式的一种令牌，由三部分组成：头部（Header）、载荷（Payload）和签名（Signature）。JWT的特点包括无状态性、轻量级、跨平台（支持多种编程语言）、可扩展性和安全性等。它已经成为了Web开发中非常流行的身份认证机制之一。

JWT由三个部分组成，分别是：
1、Header(头部):包含了token的类型和所使用的算法(例如HMAC SHA256 或 RSA)等信息。

2、Payload(负载)：包含了一些声明，用于描述用户、实体或其他数据，例如用户名、用户id和过期时间等信息。
声明主要包括Registered Claims(注册声明):这些是JWT规范中定义的属性，包括iss(表示JWT的签发者)、exp(表示JWT的到期时间)、sub(表示JWT的主题、一般是用户的ID等)等。
Public Claims(公共声明):这些是自定义的声明，可以根据需要添加。但是应该避免冲突，以免与其他声明冲突。
Private Claims(私有声明):这些是用于在特定应用程序中定义的声明，既不是Registered Claims也不是Public Claims。它们应该使用唯一的名称空间，以避免与其他声明冲突。
3、Signature(签名):用于验证消息是否完整和未被篡改。它由加密算法和密钥组成，用于验证头部和负载是否来自于预期的发送方，并且未被篡改。

JWT的核心是认证与授权。

JWT可以有效防止水平和垂直越权。
对于水平越权，JWT通过在Token中存储用户的角色或权限信息，确保只有拥有相应权限的用户才能访问特定资源。因此，如果使用JWT进行用户认证和授权，水平越权的风险将被大大降低。

对于垂直越权，JWT可以通过控制Token的时效性来解决。JWT中的过期时间允许指定一个唯一的值，这可以用来指定Token有效期的长度。在Token过期后，用户将无法使用该Token进行访问。如果攻击者获取了Token，但Token已经过而避免了垂直越权的风险。

因此，JWT在用户认证和授权方面具有很多优点，包括防止水平和垂直越权等安全问题。但是在使用时，仍需要仔细考虑和实合理的安全措施。

JWT也有以下的缺点：
Token的大小：虽然JWT是一种非常灵活的Token生成方式，允许包含任何类型的信息，但是这样也会导致Token非常大，使得在网络上传输时占用的空间较大。如果包含敏感信息，可能会带来一定的安全风险。

Token的时效性：由于Token是在服务器端生成的，如果Token已经生成并成功传输给客户端，但是此时服务器端修改了用户信息或者撤销了Token，此时Token仍然是有效的，可能会带来一定的安全风险。

Token的管理：如果Token生成数量非常多，或者某些Token需要被手动撤销或续期，则需要管理Token的有效性和状态，这可能会很麻烦。

Token的适用场景：由于JWT需要在客户端保存Token，在某些场景下可能不太适用。例如，如果用户在多个客户端登录，则需要在每个客户端都保存Token，这可能会导致Token的刷新和管理变得困难。

安全性：尽管JWT已经比普通Token更安全，但是如果在生成Token时没有进行严格的验证和校验，可能会引入安全漏洞。因此，生成和处理JWT需要小心谨慎，确保其安全性和可靠性。