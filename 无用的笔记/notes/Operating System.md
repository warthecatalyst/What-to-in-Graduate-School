# 操作系统

## 内核
**1、什么是操作系统的内核**
操作系统的内核是操作系统中最关键的部分，它是操作系统的核心组成部分，是操作系统的核心代码。内核控制着计算机资源的分配和调度，并为应用程序提供必要的服务和支持。它负责管理系统中的所有硬件设备，包括处理器、存储器、输入/输出设备等，并提供诸如进程管理、内存管理、文件系统管理、网络管理等功能。操作系统的内核的设计和实现非常复杂，它需要保证操作系统的稳定性、可靠性和安全性，在多任务、多用户环境下保证资源分配和调度的公平性和高效性。同时，内核也是与硬件直接交互的部分，需要考虑硬件的特性和限制，保证与硬件的兼容性。通常情况下，操作系统的内核是以底层服务的形式运行在操作系统的顶层上，为上层的应用程序提供支持和服务。

**2、内核态操作系统和用户态操作系统的区别**
操作系统中的内核代码通常运行在两种不同的特权级别：内核态和用户态。

内核态是指操作系统内核运行代码所拥有的最高特权级别。在内核态中，内核有权访问计算机中的所有资源，包括CPU、内存、I/O设备等。内核可以执行所有特权指令，如读写特殊寄存器、修改中断描述符表等操作。因此，内核态下的程序可以直接操作硬件，具有很高的权限和较高的执行效率。

相反，用户态是指应用程序运行时所拥有的特权级别。在用户态下，应用程序只能访问自己的地址空间，并不能直接访问操作系统内核或资源。应用程序不能执行特权指令，不能直接访问硬件，由操作系统来管理和分配资源。因此，用户态下的程序不能直接操作硬件，权限较低，执行效率也较低。


内核态和用户态的主要区别在于权限和资源的访问。内核态下的程序可以访问计算机中的所有资源，但需要非常小心，避免对操作系统和系统的稳定性造成危害。用户态下的程序由操作系统进行管理和调度，不能直接操作资源，但相对安全，可以保护操作系统免受用户程序的影响。

**3、有哪些方法可以从用户态切换到内核态**
从用户态切换到内核态是操作系统的核心操作之一，常见的方法有：

系统调用：用户程序可以通过系统调用来请求操作系统内核提供服务，如文件操作、网络请求等。当用户程序调用系统调用时，进入内核态来执行请求，完成后再返回用户态。

异常和中断：当硬件或软件出现异常或中断时，CPU会立即从用户态切换到内核态，让操作系统处理错误或响应中断。

用户态线程阻塞：当一个用户态线程请求等待某个事件发生时，如等待I/O操作完成或等待锁释放，操作系统会将该线程阻塞并切换到内核态，等待事件发生时再唤醒线程。

信号处理：用户程序可以通过信号来与操作系统内核进行通信。当操作系统内核向用户程序发送信号时，用户程序必须处理该信号，进入内核态来响应信号。

在任何情况下，从用户态切换到内核态都需要CPU完成一定的工作，如切换堆栈、保存现场状态等，这些操作会引入一定的开销，影响系统的性能。因此，在设计操作系统时需要权衡许多因素，如系统的响应时间、资源开销等。

## 进程、线程
**操作系统提供了哪些帮助进程实现进程同步的技术**：信号量、管程、消息传递。

## 内存管理
### 内存分段
分段机制下的虚拟地址由两部分组成，段选择因子和段内偏移量。

段选择子就保存在段寄存器里面。段选择子里面最重要的是段号，用作段表的索引。段表里面保存的是这个段的基地址、段的界限和特权等级等。

虚拟地址中的段内偏移量应该位于 0 和段界限之间，如果段内偏移量是合法的，就将段基地址加上段内偏移量得到物理内存地址。

### 内存分页
在分页机制下，虚拟地址分为两部分，页号和页内偏移。页号作为页表的索引，页表包含物理页每页所在物理内存的基地址，这个基地址与页内偏移的组合就形成了物理内存地址，

